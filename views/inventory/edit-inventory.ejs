<section class="form-card" aria-labelledby="edit-inventory-title">
  <!-- This view displays existing inventory data so it can be modified -->
  <h1 id="edit-inventory-title"><%= title %></h1>

  <% const flashMessages = messages(); %>
  <% if (flashMessages.trim()) { %>
    <div class="notice" role="status" aria-live="polite">
      <%- flashMessages %>
    </div>
  <% } %>

  <% if (errors) { %>
    <ul class="notice" role="alert">
      <% errors.array().forEach(error => { %>
        <li><%= error.msg %></li>
      <% }) %>
    </ul>
  <% } %>

  <form action="/inv/update" method="post" class="form" novalidate>
    <input type="hidden" name="inv_id" value="<%= locals.inv_id %>">
    <div class="form-grid">
      <div class="form-group">
        <label for="inv_make">Make</label>
        <input
          type="text"
          id="inv_make"
          name="inv_make"
          required
          value="<%= locals.inv_make %>"
        >
      </div>

      <div class="form-group">
        <label for="inv_model">Model</label>
        <input
          type="text"
          id="inv_model"
          name="inv_model"
          required
          value="<%= locals.inv_model %>"
        >
      </div>

      <div class="form-group">
        <label for="inv_year">Model year</label>
        <input
          type="number"
          id="inv_year"
          name="inv_year"
          required
          min="1900"
          step="1"
          value="<%= locals.inv_year %>"
        >
      </div>

      <div class="form-group">
        <label for="inv_price">Price</label>
        <input
          type="number"
          id="inv_price"
          name="inv_price"
          required
          min="0"
          step="0.01"
          value="<%= locals.inv_price %>"
        >
      </div>

      <div class="form-group">
        <label for="inv_miles">Mileage</label>
        <input
          type="number"
          id="inv_miles"
          name="inv_miles"
          required
          min="0"
          step="1"
          value="<%= locals.inv_miles %>"
        >
      </div>

      <div class="form-group">
        <label for="inv_color">Exterior color</label>
        <input
          type="text"
          id="inv_color"
          name="inv_color"
          required
          value="<%= locals.inv_color %>"
        >
      </div>

      <div class="form-group">
        <label for="classificationSelect">Classification</label>
        <!-- The select list is dynamically generated in utilities/index.js -->
        <%- classificationSelect %>
      </div>

      <div class="form-group form-group--full">
        <label for="inv_description">Description</label>
        <textarea
          id="inv_description"
          name="inv_description"
          required
          minlength="10"
          rows="5"
        ><%= locals.inv_description %></textarea>
      </div>

      <div class="form-group form-group--full">
        <label for="inv_image">Image path</label>
        <input
          type="text"
          id="inv_image"
          name="inv_image"
          required
          value="<%= locals.inv_image %>"
          placeholder="/images/vehicles/no-image.png"
        >
      </div>

      <div class="form-group form-group--full">
        <label for="inv_thumbnail">Thumbnail path</label>
        <input
          type="text"
          id="inv_thumbnail"
          name="inv_thumbnail"
          required
          value="<%= locals.inv_thumbnail %>"
          placeholder="/images/vehicles/no-image-tn.png"
        >
      </div>
    </div>

    <button class="button-primary" type="submit">Update vehicle</button>
  </form>
</section>

<script>
  // Keep the year input aligned with client-side expectations.
  (function () {
    const yearInput = document.getElementById("inv_year")
    if (!yearInput) return

    const currentYear = new Date().getFullYear()
    yearInput.max = String(currentYear + 1)
  })()
</script>